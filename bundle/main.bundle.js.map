{"version":3,"sources":["C:/workspace/shrabik-smart-certificate-reader/src/$_gendir lazy","C:/workspace/shrabik-smart-certificate-reader/src/app/app.component.css","C:/workspace/shrabik-smart-certificate-reader/src/app/app.component.html","C:/workspace/shrabik-smart-certificate-reader/src/app/app.component.ts","C:/workspace/shrabik-smart-certificate-reader/src/app/app.module.ts","C:/workspace/shrabik-smart-certificate-reader/src/environments/environment.ts","C:/workspace/shrabik-smart-certificate-reader/src/main.ts","external \"require('fs')\"","external \"require('http')\"","external \"require('https')\"","external \"require('nfc-pcsc')\"","external \"require('url')\"","external \"require('zlib')\""],"names":[],"mappings":"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","file":"main.bundle.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncatched exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"../../../../../src/$$_gendir lazy recursive\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/workspace/shrabik-smart-certificate-reader/src/$$_gendir lazy\n// module id = ../../../../../src/$$_gendir lazy recursive\n// module chunks = main","exports = module.exports = require(\"../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"mat-card>h3 {\\r\\n    text-align: -webkit-center;\\r\\n}\", \"\"]);\n\n// exports\n\n\n/*** EXPORTS FROM exports-loader ***/\nmodule.exports = module.exports.toString();\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/workspace/shrabik-smart-certificate-reader/src/app/app.component.css\n// module id = ../../../../../src/app/app.component.css\n// module chunks = main","module.exports = \"<mat-toolbar color=\\\"primary\\\" class=\\\"mat-elevation-z4\\\">\\n    <span>Smart Certificate Reader</span>\\n    <span fxFlex=\\\"1 1 auto\\\"></span>\\n</mat-toolbar>\\n<div width=\\\"590px\\\" height=\\\"700px\\\" style=\\\"margin-top: 10px;\\\">\\n    <mat-card *ngIf=\\\"certificateVerified == false\\\" style=\\\"width: 300px; margin-left: 120px\\\">\\n        <h3>Please scan Certificate to verify.</h3>\\n    </mat-card>\\n    <mat-card *ngIf=\\\"certificateVerified == true\\\" style=\\\"width: 300px; margin-left: 120px; margin-bottom:25px;\\\">\\n        <h3>Certificate Verified.</h3>\\n    </mat-card>\\n    <pdf-viewer *ngIf=\\\"certificateVerified == true\\\" [src]=\\\"pdfAddress\\\" [render-text]=\\\"true\\\" [page]=\\\"4\\\" [show-all]=\\\"false\\\" style=\\\"display: block;\\\" [original-size]=\\\"false\\\">\\n    </pdf-viewer>\\n</div>\"\n\n\n//////////////////\n// WEBPACK FOOTER\n// C:/workspace/shrabik-smart-certificate-reader/src/app/app.component.html\n// module id = ../../../../../src/app/app.component.html\n// module chunks = main","import { Component, OnInit, AfterViewInit } from '@angular/core';\nimport { MatSnackBar } from '@angular/material';\nimport { DomSanitizer, SafeResourceUrl } from '@angular/platform-browser';\nimport { NFC, TAG_ISO_14443_3, TAG_ISO_14443_4, KEY_TYPE_A, KEY_TYPE_B } from 'nfc-pcsc';\nimport { Subscription } from 'rxjs/Subscription';\nimport { Observable } from 'rxjs/Observable';\nimport { BehaviorSubject } from 'rxjs/BehaviorSubject';\nimport { AngularFireDatabase, AngularFireList, AngularFireAction } from 'angularfire2/database';\n\n\nimport * as firebase from 'firebase';\n\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\nexport class AppComponent implements OnInit, AfterViewInit {\n  card: any;\n  pdfAddress: any;\n  pageInPdf: number;\n  certificateVerified = false;\n  readers: Array<any> = [];\n  serialNumber$: BehaviorSubject<string | null>;\n  students$: Observable<AngularFireAction<firebase.database.DataSnapshot>[]>;\n\n  constructor(\n    public fireDb: AngularFireDatabase,\n    public snackBar: MatSnackBar,\n    public sanitizer: DomSanitizer\n  ) {\n    this.serialNumber$ = new BehaviorSubject(null);\n    this.students$ = this.serialNumber$.switchMap(serialNumber =>\n      fireDb.list('/students', ref =>\n        serialNumber ? ref.orderByChild('serialNumber').equalTo(serialNumber).limitToFirst(1) : ref\n      ).snapshotChanges()\n    );\n  }\n\n  ngOnInit () {\n    this.getPdfAddressFromDb('SS-10013');\n  }\n\n  ngAfterViewInit () {\n    const nfc = new NFC();\n    nfc.on('reader', async reader => {\n      console.log('Reader Found :', reader.name);\n      this.readers.push(reader);\n      reader.aid = 'F222222222';\n      reader.on('card', async card => {\n        // standard nfc tags like Mifare\n        if (card.type === TAG_ISO_14443_3) {\n          // const uid = card.uid;\n          console.log(`card detected`, { reader: reader.name, card });\n          this.card = card;\n        } else if (card.type === TAG_ISO_14443_4) {\n          // Android HCE\n          // process raw Buffer data\n          // const data = card.data.toString('utf8');\n          console.log(`card detected`, { reader: reader.name, card: { ...card } });\n          this.card = card;\n        } else {\n          // not possible, just to be sure\n          console.log(`card detected`, { reader: reader.name, card });\n        }\n\n        const data = await reader.read(4, 16); // await reader.read(4, 16, 16); for Mifare Classic cards\n        console.log(`data read`, { reader: reader.name, data });\n        const payload = data.toString('utf-8').trim();\n        console.log(`data converted`, payload);\n         this.getPdfAddressFromDb(payload);\n      });\n      reader.on('error', async error => {\n        console.log('Reader Error Occured :', error);\n      });\n    });\n  }\n\n  getPdfAddressFromDb (serialNumber: string) {\n    serialNumber = this.trimNullChar(serialNumber);\n    this.serialNumber$.next(serialNumber);\n    this.students$.subscribe(studentObject => {\n      console.log(studentObject);\n      if (studentObject.length === 1) {\n      this.certificateVerified = true;\n      this.pdfAddress = studentObject[0].payload.val().certificatePath;\n      this.pageInPdf = Number(studentObject[0].payload.val().pageInPdf);\n      const snackBarRef = this.snackBar.open('Certificate Verified', 'OK');\n      } else {\n        const snackBarRef = this.snackBar.open('Unverified Certificate', 'OK');\n      }\n    });\n  }\n\n  trimNullChar(sample: string) {\n    let sb = '';\n    for ( let i = 0; i < sample.length; i++) {\n      if (sample.charCodeAt(i) > 0 && sample.charCodeAt(i) <= 256) {\n        sb = sb + sample.charAt(i);\n      }\n    }\n    return sb.toString();\n  }\n\n}\n\n\n\n// WEBPACK FOOTER //\n// C:/workspace/shrabik-smart-certificate-reader/src/app/app.component.ts","import { BrowserModule } from '@angular/platform-browser';\nimport { FlexLayoutModule } from '@angular/flex-layout';\nimport { FormsModule } from '@angular/forms';\nimport { HttpModule } from '@angular/http';\nimport { NgModule } from '@angular/core';\n\nimport {\n  MatButtonModule,\n  MatCardModule,\n  MatToolbarModule,\n  MatIconModule,\n  MatGridListModule,\n  MatListModule,\n  MatProgressBarModule,\n  MatDialogModule,\n  MatProgressSpinnerModule,\n  MatSnackBarModule\n} from '@angular/material';\n\n// Import the AngularFireModule and the AngularFireDatabaseModule\nimport { AngularFireModule } from 'angularfire2';\nimport { AngularFireDatabaseModule } from 'angularfire2/database';\n\nimport { PdfViewerComponent } from 'ng2-pdf-viewer';\n\nimport { AppComponent } from './app.component';\n\n\n// Define the firebase database configuration keys, get it from your Firebase application console\nexport const firebaseConfig = {\n  apiKey: 'AIzaSyA5cSfPy8QoErJTptdHxhcpBQlN4PogYTw',\n  authDomain: 'shrabik-smart-certificate.firebaseapp.com',\n  databaseURL: 'https://shrabik-smart-certificate.firebaseio.com',\n  projectId: 'shrabik-smart-certificate',\n  storageBucket: 'shrabik-smart-certificate.appspot.com',\n  messagingSenderId: '296622038511'\n};\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    PdfViewerComponent\n  ],\n  imports: [\n    BrowserModule,\n    FormsModule,\n    HttpModule,\n    MatButtonModule,\n    MatCardModule,\n    MatToolbarModule,\n    MatIconModule,\n    MatGridListModule,\n    MatListModule,\n    MatProgressBarModule,\n    MatDialogModule,\n    MatProgressSpinnerModule,\n    MatSnackBarModule,\n    AngularFireModule.initializeApp(firebaseConfig),\n    AngularFireDatabaseModule,\n    FlexLayoutModule\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n\n\n\n// WEBPACK FOOTER //\n// C:/workspace/shrabik-smart-certificate-reader/src/app/app.module.ts","// The file contents for the current environment will overwrite these during build.\n// The build system defaults to the dev environment which uses `environment.ts`, but if you do\n// `ng build --env=prod` then `environment.prod.ts` will be used instead.\n// The list of which env maps to which file can be found in `.angular-cli.json`.\n\nexport const environment = {\n  production: false\n};\n\n\n\n// WEBPACK FOOTER //\n// C:/workspace/shrabik-smart-certificate-reader/src/environments/environment.ts","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.log(err));\n\n\n\n// WEBPACK FOOTER //\n// C:/workspace/shrabik-smart-certificate-reader/src/main.ts","module.exports = require('fs');\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"require('fs')\"\n// module id = fs\n// module chunks = main polyfills","module.exports = require('http');\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"require('http')\"\n// module id = http\n// module chunks = main","module.exports = require('https');\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"require('https')\"\n// module id = https\n// module chunks = main","module.exports = require('nfc-pcsc');\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"require('nfc-pcsc')\"\n// module id = nfc-pcsc\n// module chunks = main","module.exports = require('url');\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"require('url')\"\n// module id = url\n// module chunks = main","if(typeof require('zlib') === 'undefined') {var e = new Error(\"Cannot find module \\\"require('zlib')\\\"\"); e.code = 'MODULE_NOT_FOUND'; throw e;}\nmodule.exports = require('zlib');\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"require('zlib')\"\n// module id = zlib\n// module chunks = main"],"sourceRoot":"webpack:///"}